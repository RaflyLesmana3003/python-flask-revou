name: Deploy to Railway (development env)

on:
  push:
    branches: [develop]

jobs:
  deployment:
    runs-on: ubuntu-latest
    environment: development

    steps:
    - name: Checkout
      uses: actions/checkout@v2

    - name: Use Node 18
      uses: actions/setup-node@v1
      with:
        node-version: 18.x

    - name: Install Railway
      run: npm i -g @railway/cli

    - name: Deploy to railway
      run: railway up --service python-flask-revou
      env:
        RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
    
    
    - name: Discord notify on start
      uses: tsickert/discord-webhook@v5.3.0
      with:
        webhook-url: ${{ secrets.WEBHOOK_URL }}
        content: "CHANGES ON DEPLOY!!ðŸ”¥"